# 1.3 네트워크 코어

종단 시스템을 연결하는 패킷 스위치와 링크의 그물망
</br>
</br>

## 1.3.1 패킷 교환

- `패킷` : 출발지 종단 시스템에서 목적지 종단 시스템으로 보내기 위해 메시지를 작은 데이터 덩어리로 분할한 것
    - 패킷 스위치(라우터)와 링크 계증 스위치(link-layer switch)를 거침
    - 링크의 최대 전송률과 같은 속도로 각각의 통신 링크에서 전송된다

    - 패킷 전송 시간 = 패킷의 길이(L)/송신 속도(R)
        - R비트/초의 속도로 링크에서 L비트의 패킷을 송신한다면 그 패킷을 전송하는 데 걸리는 시간은 L/R초다.

### 저장-후-전달

- 대부분의 패킷 스위치가 이용하는 방식
- 스위치가 출력 링크로 `패킷의 첫 비트`를 전송하기 전에 전체 패킷을 받아야 함
- 라우터는 보통 여러 개의 링크를 갖는다.
    - 입력되는 패킷을 출력 링크로 교환함

![image](https://github.com/user-attachments/assets/0403b233-ef75-4b18-80d3-555d5164eb3b)
- 그림에서 라우터는 입력링크에서 다른 접속 링크로 패킷을 전달하는 간단한 기능을 가짐
  - 라우터는 받은 패킷의 비트를 buffer(store)한 후 패킷의 모든 비트를 수신한 후에 출력 링크로 패킷을 transmit(forward)하기 시작

- 전파 지연 무시한 전송 시간 계산
  - 0초: 출발지에서 전체 패킷 전송 시작
  - L/R초: 출발지에서 보낸 전체 패킷이 모두 라우터에 도착, 라우터에서 목적지를 향해 패킷을 출력 링크로 전송 시작
  - 2L/R초: 라우터에서 보낸 전체 패킷이 모두 목적지 수신 시스템에에 도착
  - 전체 지연은 2L/R
  - 만약 라우터(스위치)에서 비트가 지연되지 않는다면 L/R이 되지만 라우터는 전달하기에 앞서 전체 패킷을 수신, 저장, 처리할 필요가 있다 (->1.4절)

- 목적지 노드가 3개의 모든 패킷을 수신할때까지 경과되는 시간
    - 한 번 전송할 때 L/R걸리므로 4L/R
<img src="https://github.com/user-attachments/assets/9fe50551-842b-4d38-92bf-703168d47b8f" width="500"/>


 
 
- 출발지로부터 목적지 노드까지 N개의 링크로 구성되고 각각 전송률이 R인 경로를 통해 하나의 패킷을 전송하는 경우 (N-1개의 라우터)
     - 종단 간 지연 ![image](https://github.com/user-attachments/assets/5568633a-617e-4dd5-a87a-e094c1228ab4)


</br>
</br>

### 큐잉 지연과 패킷 손실

- 출력 버퍼
    - 패킷 스위치는 여러개의 링크를 가지고 각 링크에 대해 출력 버퍼(출력 큐)를 가지고 있음

- `큐잉 지연`(queuing dalay)
    - 한 패킷이 도착했을 때 링크가 다른 패킷을 전송하고 있다면 도착한 패킷이 출력 버퍼에서 대기하는 것
    - 네트워크의 혼잡 정도에 따른다.
    - `패킷 손실(packet loss)`: 버퍼가 꽉 차서 도착하는 패킷이나 이미 큐에 대기중인 패킷을 폐기(drop)하는 것

</br>

![image](https://github.com/user-attachments/assets/722ea713-3acb-4aea-bf0e-61c68093c866)

- 이 그림에서 모든 패킷은 같은 너비(비트수)와 길이를 갖는다
    - 짧은 기간 동안에 라우터에 도착하는 패킷의 전송률이 1.5Mbps를 초과하면 라우터에서 혼잡이 발생하게 되고 링크로 전송되기 전에 링크의 출력 버퍼에 큐잉된다.
    - 호스트 a,b가 동시에 연속해서 5개의 패킷을 송신하면 이들 패킷의 대부분은 큐에서 대기하는 데 시간을 보낼 것이다.

(-> 1.4절)

</br>

### 포워딩 테이블, 라우팅 프로토콜

- 라우팅: 패킷 전달하는 법. 갈림길마다 서서 방향을 물어보고 가는 것

- `IP 주소`: 모든 종단 시스템이 가짐, 계층적 구조를 가짐
    - 발송하는 패킷의 헤더에 목적지의 IP주소를 넣음
    
- `포워딩 테이블`: 목적지 주소 혹은 주소의 일부를 라우터의 출력 링크로 매핑함
    - 패킷이 라우터에 도착하면 라우터는 올바른 출력링크를 찾기 위해 주소를 조사하고 목적지 주소를 이용해 포워딩테이블을 검색한다. 그 후 출력 링크로 전송
    - 포워딩 테이블이 어떻게 설정되는가 등 ->5장

- 인터넷은 여러 특별한 `라우팅 프로토콜`을 가진다.: 자동으로 포워딩 테이블을 설정하는 프로토콜

</br>
</br>


## 1.3.2 회선 교환

- 데이터를 이동시키는 두 가지 기본 방식
    - 회선 교환(circuit switching) 네트워크: 예약을 요구하는 식당
    - 패킷 교환(packet switching) 네트워크: 예약 필요 없는 식당

- `회선 교환 네트워크`
    - 종단 시스템 간에 통신을 제공하기 위해 경로상에 필요한 자원(버퍼, 링크 전송률)은 통신 세션 동안에 확보 또는 예약(reserve)된다.
    - 세션 메시지는 on-demand 방식으로 자원을 요청하여 사용하고 통신 링크에 대한 접속을 위해 기다릴(큐에서 대기) 수도 있다.
    - 예) 전통적인 전화망
    - `회선`: 송신자와 수신자 간의 경로에 있는 스위치들이 해당 연결 상태를 유지해야 하는 연결
    - 네트워크가 회선을 설정할 때 그 연결이 이루어지는 동안 네트워크 링크(각링크의전송용량의일부)에 일정한 전송률을 예약한다.
    - 보장된 일정 전송률로 데이터를 보낼 수 있다.

그림 1.13

</br>

### 회선 교환 네트워크에서의 다중화




### 패킷 교환 대 회선 교환



## 1.3.3 네트워크의 네트워크
